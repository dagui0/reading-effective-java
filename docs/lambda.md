# 람다 스페셜

## 목차

* [람다 그거 먹는건가요?](#람다-그거-먹는건가요)
  * [역사와 개념](#역사와-개념)
  * [표기법](#표기법)
  * [변환과 계산](#변환과-계산)
  * [클로저(closure)](#클로저closure)
  * [무엇에 쓰는 물건인고?](#무엇에-쓰는-물건인고)
* [Java 람다 표현식](#Java-람다-표현식)
  * [람다 표현식 문법](#람다-표현식-문법)
  * [내장 함수 인터페이스](#내장-함수-인터페이스)
  * [스트림 API와 컬렉션 조작](#스트림-API와-컬렉션-조작)
  * [비동기 처리](#비동기-처리)
  * [동시성 처리](#동시성-처리)
* [그럼 람다가 짱인가요?](#그럼-람다가-짱인가요)

## 람다 그거 먹는건가요?

### 역사와 개념

### 표기법

### 변환과 계산

### 클로저(closure)

### 무엇에 쓰는 물건인고?

## Java 람다 표현식

### 람다 표현식 문법

### 내장 함수 인터페이스

### 스트림 API와 컬렉션 조작

### 비동기 처리

### 동시성 처리

## 그럼 람다가 짱인가요?

### QuickSort 성능 비교

테스트 비교군 정의

* Java
  * `array`: `int[]` 사용 절차적 프로그램
  * `list`: `List<Integer>` 사용 절차적 프로그램 
  * `lambda`: `List<Integer>.stream()` 사용 함수형 프로그램
* Kotlin
  * `array`: `IntArray` 사용 절차적 프로그램
  * `list`: `List<Int>` 사용 절차적 프로그램
  * `lambda`: `List<Int>` 사용 함수형 프로그램

> 단위: `java array` 대비 비율

| lang | method | 3 | 10 | 100 | 1k | 10k | 100k | 1M |
|------|--------|---|----|-----|----|-----|------|----|
| java | array | 1.0 | 1.0 | 1.0 | 1.0 | 1.0 | 1.0 | 1.0 |
| java | list | 2.1 | 3.5 | 4.1 | 2.7 | 3.3 | 2.7 | 4.3 |
| java | lambda | 22.4 | 55.6 | 31.3 | 22.2 | 33.0 | 20.0 | 13.0 |
| kotlin | array | 2579.4 | 0.8 | 0.8 | 1.2 | 1.2 | 1.0 | 1.0 |
| kotlin | list | 998.7 | 2.2 | 2.2 | 2.6 | 3.2 | 2.6 | 4.3 |
| kotlin | lambda | 1642.3 | 24.1 | 14.0 | 14.3 | 14.9 | 13.5 | 10.9 |

<details>
<summary>ms 단위 보기</summary>

| lang | method | 3 | 10 | 100 | 1k | 10k | 100k | 1M |
|------|--------|---|----|-----|----|-----|------|----|
| java | array | 0.005 | 0.005 | 0.050 | 0.323 | 0.993 | 5.998 | 72.889 |
| java | list | 0.010 | 0.017 | 0.206 | 0.858 | 3.272 | 16.096 | 315.650 |
| java | lambda | 0.110 | 0.278 | 1.568 | 7.166 | 32.749 | 119.956 | 946.153 |
| kotlin | array | 12.639 | 0.004 | 0.039 | 0.374 | 1.231 | 5.893 | 71.227 |
| kotlin | list | 4.894 | 0.011 | 0.109 | 0.847 | 3.209 | 15.866 | 316.333 |
| kotlin | lambda | 8.047 | 0.121 | 0.702 | 4.631 | 14.806 | 81.056 | 792.388 |

</details>

* 일반적인 성능에 대한 커뮤니티 의견(Kotlin >= Java)이 맞는 것으로 보임
* Kotlin 3건 대상의 경우 매우 느린데, Java에서 Kotlin 코드 실행시 초기화 작업(jit 컴파일 같은)이 필요한 것으로 보임
* 반대로 Kotlin에서 Java 코드 실행시에는 훨씬 덜한 것으로 보이며 `java lamda`에서만 발생함.
  <details>
    <summary>숫자 보기</summary>

    > 테스트 실행시마다 랜덤수로 배열을 생성하므로 java에서 실행한 결과와 1:1 비교는 불가능함

    | lang | method | 3 | 10 | 100 | 1k | 10k | 100k | 1M |
    |------|--------|---|----|-----|----|-----|------|----|
    | java | array | 1.0 | 1.0 | 1.0 | 1.0 | 1.0 | 1.0 | 1.0 |
    | java | list | 2.9 | 3.3 | 3.3 | 2.1 | 2.8 | 2.6 | 4.2 |
    | java | lambda | 227.6 | 55.2 | 34.1 | 21.7 | 24.7 | 19.1 | 13.7 |
    | kotlin | array | 0.7 | 0.9 | 0.7 | 0.9 | 1.0 | 1.0 | 1.0 |
    | kotlin | list | 1.7 | 3.1 | 1.8 | 2.1 | 2.7 | 3.1 | 4.2 |
    | kotlin | lambda | 7.2 | 23.5 | 10.6 | 11.4 | 12.0 | 10.6 | 11.0 |
    
    | lang | method | 3 | 10 | 100 | 1k | 10k | 100k | 1M |
    |------|--------|---|----|-----|----|-----|------|----|
    | java | array | 0.006 | 0.003 | 0.060 | 0.325 | 1.183 | 5.947 | 69.891 |
    | java | list | 0.018 | 0.011 | 0.199 | 0.670 | 3.288 | 15.225 | 294.623 |
    | java | lambda | 1.389 | 0.177 | 2.030 | 7.040 | 29.266 | 113.410 | 958.802 |
    | kotlin | array | 0.004 | 0.003 | 0.043 | 0.306 | 1.156 | 6.237 | 69.246 |
    | kotlin | list | 0.010 | 0.010 | 0.106 | 0.672 | 3.147 | 18.153 | 295.639 |
    | kotlin | lambda | 0.044 | 0.075 | 0.630 | 3.710 | 14.202 | 63.236 | 770.101 |

  </details>

### 결론

* Stream API와 람다식을 이용하여 가독성을 높이고 코드의 복잡성을 줄이는 것은 좋다.
* 하지만 함수형 프로그래밍에 심취하여 알고리즘을 함수형으로 구현하는 개발자가 있다면 혼쭐 내주자.
* 그래도 람다식이 눈에 안들어온다면 성능과 짬밥을 무기로 찍어 누르자.

## 기타

### 데이터 테이블 예제

* STUDENT

|   S_NO   | NAME | ADDRESS |
|:--------:|:----:|:-------:|
| 20231001 | 홍길동  |   강남구   |
| 20231002 | 이순신  |   종로구   |
| 20231003 | 강감찬  |   서초구   |
| 20231004 | 유관순  |   마포구   |

* CLASS

|   C_NO   | CLASS_NAME | TEACHER |
|:--------:|:---------:|:-------:|
| 20231001 |   수학    |   김철수  |
| 20231002 |   과학    |   이영희  |
| 20231003 |   영어    |   박영수  |

* STUDENT_CLASS

|   S_NO   |   C_NO   |
|:--------:|:-------:|
| 20231001 | 20231001 |
| 20231002 | 20231002 |
| 20231003 | 20231001 |
| 20231004 | 20231003 |


```sql
SELECT S.S_NO, S.NAME, S.ADDRESS, C.CLASS_NAME, C.TEACHER
FROM STUDENT S,
     STUDENT_CLASS SC,
     CLASS C
WHERE S.S_NO = SC.S_NO
  AND SC.C_NO = C.C_NO
  AND S.NAME = '홍길동';
```
